[extruder]
step_pin: P2.3
dir_pin: !P0.22
enable_pin: !P0.21
microsteps: 16
rotation_distance: 22.857
nozzle_diameter: 0.4
filament_diameter: 1.75
heater_pin: P2.7
sensor_type: EPCOS 100K B57560G104F
sensor_pin: P0.23
control: pid
pid_Kp: 15
pid_Ki: 0.5
pid_Kd: 25
min_temp: -150
max_temp: 320

[gcode_macro T0]
gcode:
    ACTIVATE_EXTRUDER extruder=extruder

[gcode_macro M109]
rename_existing: M109.1
gcode:
    STATUS_LED STATUS=started
    M109.1 T{params.T} S{params.S}
    STATUS_LED STATUS=printing

[gcode_macro INSERT_MATERIAL]
gcode:
    G91
    {% set active_extruder = printer.toolhead.extruder %}
    {% if active_extruder == 'extruder' %}
        G1 E130
    {% elif active_extruder == 'extruder1' %}
        G1 E1500
    {% endif %}
    G90

[gcode_macro LOAD_MATERIAL]
gcode:
    G91
    G1 E20
    G90

[gcode_macro RETRACT_MATERIAL]
gcode:
    G91
    G1 E-20
    G90

[gcode_macro EJECT_MATERIAL]
gcode:
    G91
    {% set active_extruder = printer.toolhead.extruder %}
    {% if active_extruder == 'extruder' %}
        G1 E-130
    {% elif active_extruder == 'extruder1' %}
        G1 E-1500
    {% endif %}
    G90